---
name: issue-creator
description: ユーザーとの対話を通じて適切なGitHub Issueを作成する統合スキル。コード分析結果からのIssue作成、初級者向けタスクのIssue化、通常のIssue作成など、文脈に応じて最適な方法でIssueを生成する。「issueを作成して」「分析結果からissueにして」「good first issueを作って」などの依頼に対応
---

# Issue Creator - GitHub Issue作成統合スキル

ユーザーとの対話を通じて、文脈に応じた適切なGitHub Issueを作成する統合スキルです。

## 使用タイミング

### 通常のIssue作成
- 「Issueを作成して」
- 「バグを報告したい」
- 「機能追加のIssueを作りたい」
- 「問題をIssueにして」

### コード分析結果からのIssue作成
- 「分析結果からissueを作成して」
- 「この問題をissue化して」
- 「バグレポートをGitHubに登録して」
- 「エラーをissueにまとめて」

### 初級者向けIssue作成
- 「初級者向けissueを作成して」
- 「good first issueを登録して」
- 「ビギナー向けタスクをissue化して」
- 「簡単なissueを作成して」

## 実行フロー

### ステップ1: プロジェクト環境の確認

1. **Gitリポジトリの確認**
   ```bash
   git status
   ```

2. **標準ラベルの読み込み**
   `.claude/labels.md`から標準ラベル定義を読み込み:
   ```bash
   if [ -f ".claude/labels.md" ]; then
     cat .claude/labels.md
   else
     echo "警告: .claude/labels.mdが見つかりません"
     echo "/copy-labelsを実行してラベルを設定することを推奨します"
   fi
   ```

### ステップ2: Issue作成モードの判定

**モード判定ロジック**:

#### 自動判定（確認なしで実行）

以下のキーワードが含まれる場合、確認なしで直接該当モードで実行:

**コード分析モード（モード3）**:
- 「分析結果から」「エラーから」「分析からissue」
- 「静的解析の結果」「チェック結果から」
- コード分析が直前に実行済みで、その結果への言及がある場合

**Good First Issueモード（モード2）**:
- 「初級者向けissue」「good first issue」「ビギナー向け」
- 「新人向けタスク」「簡単なissue」（文脈が明確な場合）

#### ユーザー確認が必要な場合

上記以外の曖昧な依頼の場合、以下のプロンプトでモードを確認:

```
どのモードでIssueを作成しますか？

1. 通常モード
   - 1つまたは複数のIssueを対話形式で作成
   - バグ報告、機能追加、ドキュメント更新など

2. Good First Issueモード
   - 初級者向けタスクを自動特定してIssue作成
   - 詳細な実装手順付き

3. コード分析モード
   - コード分析結果から複数のIssueを一括作成
   - 優先度・粒度・グループ化を設定可能

番号を選択してください (1/2/3):
```

**確認が必要なケース例**:
- 「issueを作成して」（文脈不明）
- 「バグを報告したい」（単一Issueか分析結果かが不明）
- 「タスクをissue化して」（種別が不明）

#### モード1: **通常Issue作成モード**

**選択時の動作**:
1. Issue情報の対話的な聞き取り
2. Issue内容のプレビュー
3. ユーザー確認後に作成

**このモードが適している場合**:
- 1つまたは少数のIssueを作成したい
- バグ報告、機能追加リクエスト、ドキュメント更新など
- 特定の問題を詳細に記述したい

#### モード2: **Good First Issue作成モード**

**選択時の動作**:
1. プロジェクト構造の分析
2. 初級者向けタスクの特定（ドキュメント/UI/テスト/アクセシビリティなど）
3. タスクの難易度評価
4. 詳細な実装手順の生成

**このモードが適している場合**:
- 初級者がコントリビュートしやすいタスクを作成したい
- プロジェクトへの新規参加者を歓迎したい
- 詳細な手順付きのIssueが必要

#### モード3: **コード分析Issue作成モード**

**選択時の動作**:
1. 分析結果のサマリー表示
2. Issue作成範囲の確認（全て/Critical/High/カテゴリ指定）
3. Issue粒度の確認（詳細/中/粗）
4. グループ化基準の確認（ファイル/機能/エラー種類/自動）

**このモードが適している場合**:
- コード分析（`code-analyzer`）を実行済み
- 分析結果から多数のIssueを一括作成したい
- 優先度やカテゴリでフィルタリングしたい

### ステップ3: 各モードの詳細処理

---

## モード1: コード分析Issue作成

### 3-1-1: 分析結果のサマリー表示

```
📊 コード分析結果サマリー

総問題数: 362件
- 🔴 Critical: 31件（ビルドエラー、欠落ファイル）
- 🟠 High: 148件（型エラー、未定義メソッド）
- 🟡 Medium: 150件（Null安全性、リファクタリング）
- ⚪ Low: 33件（デバッグコード、TODOコメント）

カテゴリ別:
- 🐛 バグ: 180件
- 🔧 リファクタリング: 120件
- 📝 ドキュメント: 36件
- ⚡ パフォーマンス: 15件
- 🧪 テスト: 11件
```

### 3-1-2: Issue作成範囲の確認

ユーザーに確認:

```
どの範囲でIssueを作成しますか？

1. すべて作成（362件）※推奨しません
2. Critical + Highのみ（179件）
3. Criticalのみ（31件）
4. カテゴリを指定（例: バグのみ）
5. 優先度と範囲を指定（例: Critical+High かつ バグのみ）
6. カスタム（詳細に指定）
```

### 3-1-3: Issue粒度の確認

```
Issue作成の粒度はどうしますか？

1. 詳細（1問題 = 1Issue）- 多数のIssueが作成されます
2. 中粒度（関連する問題をグループ化）- 推奨
3. 粗粒度（カテゴリごとに1Issue）- 管理しやすいが詳細度が低い
```

### 3-1-4: グループ化基準（中粒度の場合）

```
問題のグループ化基準:

1. ファイル単位（同じファイルの問題をまとめる）
2. 機能単位（同じ機能の問題をまとめる）
3. エラー種類単位（同じエラータイプをまとめる）
4. 自動判定（関連性の高い問題を自動グループ化）
```

### 3-1-5: Issue内容の生成

各Issueを以下の形式で生成:

#### タイトル形式
```
[カテゴリ] 簡潔な説明 (影響範囲)
```

例:
- `[Bug] 欠落モデルファイルの作成 (Badge, Goal関連)`
- `[Refactoring] 未定義メソッドの実装 (AnswerRepository)`

#### Issue本文テンプレート

```markdown
## 問題の概要
[問題の簡潔な説明]

## 影響範囲
- 影響を受けるファイル一覧
- 影響を受ける機能

## 詳細
### 発生している問題
[具体的なエラー内容や問題の詳細]

### 原因
[問題の原因分析]

## 修正方法
### 推奨アプローチ
[推奨される修正方法]

### 実装手順
1. [手順1]
2. [手順2]
3. [手順3]

### コード例（該当する場合）
\`\`\`
// 修正前
[問題のあるコード]

// 修正後
[修正後のコード]
\`\`\`

## チェックリスト
- [ ] コード修正
- [ ] テスト追加/修正
- [ ] ドキュメント更新

## 優先度
[Critical/High/Medium/Low] - [理由]

## 見積もり
[作業時間の目安]
```

#### 標準ラベルのマッピング

`.claude/labels.md`から読み込んだラベルを使用:

- **Type系ラベル**（必須）
  - バグ → `Type：バグ`
  - リファクタリング → `Type：リファクタリング`
  - ドキュメント → `Type：ドキュメント更新`
  - 新機能 → `Type：新機能・既存改修`

- **Priority系ラベル**（必須）
  - Critical → `Priority：最優先`
  - High → `Priority：中`
  - Medium → `Priority：中`
  - Low → `Priority：低`

---

## モード2: Good First Issue作成

### 3-2-1: 初級者向けタスクの特定

以下のカテゴリから適切なタスクを探索:

#### 📝 ドキュメント改善

```bash
# READMEの不足確認
grep -r "TODO" README.md
grep -r "WIP" docs/

# コメント不足の関数を検索
grep -r "export function" --include="*.ts" | wc -l
grep -r "\/\*\*" --include="*.ts" | wc -l
```

**タスク例**:
- READMEにインストール手順を追加
- API関数にJSDocコメントを追加
- コントリビューションガイドの作成

#### 🎨 UI/スタイル改善

```bash
# TODOコメントを検索
grep -r "TODO.*style" --include="*.css" --include="*.scss"
grep -r "FIXME.*color" --include="*.tsx"
```

**タスク例**:
- ボタンのホバー効果追加
- カラースキームの統一
- レスポンシブデザインの微調整

#### 🐛 簡単なバグ修正

**タスク例**:
- テキストのタイポ修正
- リンク切れの修正
- エラーメッセージの改善

#### 🧪 テスト追加

**タスク例**:
- 既存関数の単体テスト追加
- テストケースのカバレッジ向上

#### ♿ アクセシビリティ改善

```bash
# aria属性の欠如をチェック
grep -r "<button" --include="*.tsx" | grep -v "aria-label"
grep -r "<img" --include="*.html" | grep -v "alt="
```

**タスク例**:
- ボタンにaria-labelを追加
- 画像にalt属性を追加

#### 🔧 コードクリーンアップ

**タスク例**:
- 未使用のインポート削除
- console.logの削除
- フォーマットの統一

### 3-2-2: タスクの評価と選定

各候補タスクを評価:

**選定基準**:
- 難易度スコア ≤ 3 (1-5点)
- 影響範囲スコア ≤ 3 (1-5点)
- 学習価値スコア ≥ 2 (1-5点)

### 3-2-3: Good First Issue内容の構成

```markdown
## 📋 タスクの概要
[タスクの簡潔な説明]

## 👥 対象者
- プロジェクトに初めて貢献する方
- [必要な基本知識]
- 所要時間: [見積時間]

## 📝 実装手順

### 1. リポジトリをフォーク・クローン
\`\`\`bash
git clone https://github.com/YOUR_USERNAME/[project-name].git
cd [project-name]
\`\`\`

### 2. [作業内容]
[詳細な手順とコード例]

### 3. 変更を確認
[確認方法]

### 4. コミットしてプッシュ
\`\`\`bash
git add [ファイル]
git commit -m "[コミットメッセージ]"
git push origin main
\`\`\`

### 5. プルリクエストを作成
[PR作成の手順]

## 📚 学習リソース
- [関連ドキュメントへのリンク]

## ✅ 完了基準
- [ ] [チェック項目1]
- [ ] [チェック項目2]
- [ ] [チェック項目3]
```

#### 標準ラベル

- `Type：good first issue`（必須）
- カテゴリラベル（`Type：ドキュメント更新`など）
- `Priority：低` または `Priority：中`

---

## モード3: 通常Issue作成

### 3-3-1: Issue情報の対話的聞き取り

ユーザーに以下を質問:

1. **Issueのタイトル** (必須)
   - 「Issueのタイトルを教えてください」

2. **Issue種別** (任意、デフォルト: バグ)
   - 「Issue種別を選択してください」
     - バグ → `Type：バグ`
     - 新機能 → `Type：新機能・既存改修`
     - ドキュメント → `Type：ドキュメント更新`
     - リファクタリング → `Type：リファクタリング`
     - 質問・相談 → `Type：質問・相談`
     - その他 → `Type：作業`

3. **優先度/緊急度** (任意、デフォルト: 中)
   - **通常のIssue**:
     - 最優先 → `Priority：最優先`
     - 高 → `Priority：中`
     - 中 → `Priority：中`
     - 低 → `Priority：低`
   - **質問・相談の場合**:
     - 高 → `緊急度：高`
     - 中 → `緊急度：中`
     - 低 → `緊急度：低`

4. **問題の詳細** (必須)
   - 「問題の詳細を教えてください（複数行可）」

5. **再現手順** (任意)
   - 「再現手順があれば教えてください（なければスキップ）」

6. **期待する動作** (任意)
   - 「期待する動作があれば教えてください（なければスキップ）」

7. **追加情報** (任意)
   - 「その他追加情報があれば教えてください（なければスキップ）」

### 3-3-2: Issue本文テンプレート

```markdown
## 問題の詳細

{詳細}

{再現手順がある場合}
## 再現手順

{再現手順}

{期待する動作がある場合}
## 期待する動作

{期待する動作}

{追加情報がある場合}
## 追加情報

{追加情報}
```

---

## ステップ4: Issue内容のプレビューと確認

生成したIssue内容をユーザーに提示:

```
作成予定のIssue一覧:

1. [Bug] 欠落モデルファイルの作成
   - 優先度: Critical
   - 影響: badge.dart, goal.dart
   - 見積: 4-6時間

2. [Bug] パス記述エラーの修正
   - 優先度: High
   - 影響: goal_management_usecase.dart
   - 見積: 30分

[...]

このままIssueを作成しますか？
- はい（すべて作成）
- 一部のみ作成（番号を指定）
- 内容を修正
- キャンセル
```

## ステップ5: GitHub Issue作成

### 5-1: Issue作成実行

承認後、順次Issueを作成:

```bash
# 標準ラベルを使用したIssue作成
gh issue create \
  --title "[Bug] 欠落モデルファイルの作成 (Badge, Goal関連)" \
  --body-file issue_content.md \
  --label "Type：バグ" \
  --label "Priority：最優先"

# Good First Issueの場合
gh issue create \
  --title "[Good First Issue] READMEにインストール手順を追加" \
  --body-file issue_content.md \
  --label "Type：good first issue" \
  --label "Type：ドキュメント更新" \
  --label "Priority：低"

# 質問・相談の場合
gh issue create \
  --title "認証フローの設計について相談" \
  --body-file issue_content.md \
  --label "Type：質問・相談" \
  --label "緊急度：中"
```

### 5-2: ラベルが存在しない場合の対応

```bash
# ラベル適用を試行し、エラーの場合はラベルなしで作成
if ! gh issue create --title "..." --body "..." --label "Type：バグ" --label "Priority：中" 2>/dev/null; then
  echo "⚠️ 警告: ラベルが存在しないため、ラベルなしでIssueを作成します"
  ISSUE_URL=$(gh issue create --title "..." --body "...")
  echo "✓ Issue作成: $ISSUE_URL"
  echo ""
  echo "次のステップ:"
  echo "1. /copy-labels を実行して標準ラベルをプロジェクトに設定"
  echo "2. 作成されたIssueに手動でラベルを適用"
fi
```

### 5-3: 作成時の注意点

1. **レート制限への配慮**
   - 大量Issue作成時は5件ごとに1秒待機
   - エラー発生時は自動リトライ（最大3回）

2. **標準ラベルの適用**
   - `.claude/labels.md`から読み取った標準ラベルを使用
   - プロジェクトに標準ラベルが未設定の場合は警告を表示

## ステップ6: 作成結果の報告

### 6-1: 作成完了サマリー

```
✅ Issue作成完了

作成したIssue: 10件

Critical:
- #45: [Bug] 欠落モデルファイルの作成
- #46: [Bug] 欠落リポジトリインターフェースの作成

High:
- #47: [Bug] パス記述エラーの修正
- #48: [Refactoring] 未定義メソッドの実装
[...]

次のステップ:
1. Critical Issueから優先的に対応
2. 各Issueにブランチを作成して修正
3. PRを作成してレビュー
```

### 6-2: レポートファイルの生成（オプション）

`./reports/issues_created_yyyyMMddHHmm.md`に保存:

```markdown
# GitHub Issue作成レポート

作成日時: 2025-11-26 14:30
プロジェクト: [project-name]

## 作成サマリー
- 総作成数: 10件
- Critical: 2件
- High: 5件
- Medium: 3件

## 作成したIssue一覧

### Critical
- #45: [Bug] 欠落モデルファイルの作成
  - URL: https://github.com/user/repo/issues/45
  - 見積: 4-6時間

[...]
```

## エラーハンドリング

### GitHub認証エラー

```
エラー: GitHub認証が必要です。
以下のコマンドで認証してください:
  gh auth login
```

### Issue作成失敗

```
エラー: Issue #X の作成に失敗しました
原因: API rate limit exceeded
対処: 1時間後に再実行するか、--retry オプションで自動リトライ
```

### レート制限

```
警告: GitHubのレート制限に達しました
作成済み: 50件 / 予定: 100件
残り50件は1時間後に自動再開しますか？
```

### ラベルが存在しない

```
警告: 標準ラベルが存在しません
/copy-labelsを実行してラベルを設定することを推奨します
ラベルなしでIssueを作成しますか？ (y/n)
```

## 使用例

### 例1: 通常のバグ報告

**ユーザー**: バグを報告したい

**スキルの動作**:
```
スキル: どのモードでIssueを作成しますか？

1. 通常モード
2. Good First Issueモード
3. コード分析モード

推奨: 1. 通常モード
番号を選択してください (1/2/3):
```

**ユーザー**: 1

**スキルの動作**:
1. 通常Issue作成モードで起動
2. タイトル、種別、優先度、詳細を聞き取り
3. Issue内容をプレビュー
4. 確認後、GitHub Issueを作成
5. Issue URLを報告

### 例2: コード分析結果からIssue作成（自動判定）

**ユーザー**: growth-diaryの分析結果から、Criticalのissueだけ作成して

**スキルの動作**:
```
スキル: 「分析結果から」というキーワードを検出
→ コード分析モード（モード3）で自動起動
```

**スキルの動作**:
1. コード分析Issue作成モードで起動（確認なし）
2. 分析結果を整理（362件 → Critical 31件に絞り込み）
3. サマリーを表示
4. Issue粒度を確認（中粒度を推奨）
5. グループ化基準を確認（自動判定を推奨）
6. 5件のIssueを生成（グループ化後）
7. 内容を提示して承認待ち
8. 承認後、GitHub Issueを作成
9. 結果レポート表示

### 例3: Good First Issue作成（自動判定）

**ユーザー**: 初級者向けissueを5件作成して

**スキルの動作**:
```
スキル: 「初級者向けissue」というキーワードを検出
→ Good First Issueモード（モード2）で自動起動
```

**スキルの動作**:
1. Good First Issue作成モードで起動（確認なし）
2. プロジェクト構造を分析
3. 初級者向けタスクを5件特定
4. 各タスクに詳細な手順を生成
5. ユーザーに確認
6. Good First Issueを5件作成
7. 結果レポート表示

### 例4: モード確認が必要な場合

**ユーザー**: issueを作成して

**スキルの動作**:
```
スキル: キーワードが曖昧なため、モードを確認

どのモードでIssueを作成しますか？

1. 通常モード
   - 1つまたは複数のIssueを対話形式で作成
2. Good First Issueモード
   - 初級者向けタスクを自動特定してIssue作成
3. コード分析モード
   - コード分析結果から複数のIssueを一括作成

番号を選択してください (1/2/3):
```

**ユーザー**: 1

**スキルの動作**:
1. 通常Issue作成モードで起動
2. Issue情報を対話的に聞き取り
3. Issue作成

## 設定オプション

環境変数でカスタマイズ可能:

```bash
# デフォルトの粒度（fine/medium/coarse）
export ISSUE_DEFAULT_GRANULARITY=medium

# デフォルトの優先度フィルター
export ISSUE_DEFAULT_PRIORITY=critical,high

# 自動アサイン
export ISSUE_AUTO_ASSIGN=true

# マイルストーン
export ISSUE_DEFAULT_MILESTONE=v1.0

# レポート出力先
export ISSUE_REPORT_DIR=./reports

# レート制限の待機時間（秒）
export ISSUE_RATE_LIMIT_WAIT=1
```

## 注意事項

1. **大量Issue作成の警告**
   - 20件以上作成する場合は必ず警告を表示
   - ユーザーに粒度の見直しを提案

2. **既存Issue重複チェック**
   - タイトルの類似度をチェック
   - 70%以上類似している場合は警告

3. **プライベートリポジトリ権限**
   - Issue作成権限を事前確認
   - 権限不足の場合はエラー表示

4. **ユーザー対話の重要性**
   - 自動判断せず、必ずユーザーに確認
   - 特に粒度とフィルター条件は重要

5. **標準ラベルの管理**
   - `.claude/labels.md`を必ず参照
   - ラベルが存在しない場合は適切に対応

## 制限事項

- GitHub CLIがインストールされている必要がある
- Gitリポジトリ内で実行する必要がある
- リモートリポジトリが設定されている必要がある
- GitHub認証が完了している必要がある

## 関連スキル・コマンド

- `issue-fixer` - Issue対応スキル（後工程）
- `pr-creator` - PR作成スキル（後工程）
- `/analyze-errors` - エラー分析コマンド（前工程）
- `/copy-labels` - 標準ラベル設定コマンド

## トラブルシューティング

### スキルが発動しない

- 「issue作成」「issueを作って」などのキーワードを含めて依頼
- 例: 「バグをissueにして」

### 分析結果が見つからない

- 先に`code-analyzer`スキルでコード分析を実行
- または直接分析結果を提供

### 適切なタスクが見つからない（Good First Issue）

- プロジェクトが成熟していて改善余地が少ない可能性
- TODOコメントを追加してタスクを明示化
- ドキュメント不足がないか確認

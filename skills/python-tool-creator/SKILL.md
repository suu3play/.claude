# 社内用Pythonツール作成スキル

社内用Pythonツール作成を効率化するためのスキルです。5種類のベース機能テンプレートを提供し、必要に応じて組み合わせて使用できます。

## 使用例

```
社内用Pythonツールを作成して
ChatGPTで分析してSlackに通知するツールを作成して
勤怠データを取得してTeamsに送るツール
```

## スキルの動作

このスキルを起動すると、以下の流れで対話しながらツールを作成します：

1. **目的のヒアリング**: 何をするツールか確認
2. **ベース機能の選択**: 必要な機能を選択（複数選択可能）
   - ChatGPT応答ベース
   - Slack通知ベース
   - Teams通知ベース
   - 従業員情報取得ベース (KOT)
   - 勤怠情報取得ベース (KOT)
3. **カスタマイズ**: 必要に応じて追加要件を確認
4. **ファイル生成**: 選択されたベース機能を統合したコードを生成

## 生成されるファイル

- `main.py`: メイン処理ロジック
- `config.yaml`: 設定ファイル
- `.env.example`: 環境変数のサンプル
- `requirements.txt`: 必要なパッケージ一覧
- `README.md`: ツールの使用方法
- `.gitignore`: Git除外設定

## ベース機能詳細

### 1. ChatGPT応答ベース
OpenAI GPT-4o APIを使用した対話型処理
- プロンプトテンプレート管理
- ストリーミング応答対応
- 会話履歴管理
- エラーハンドリング

### 2. Slack通知ベース
Slackへの通知送信
- Webhook/Bot Token両対応
- リッチメッセージフォーマット
- チャンネル・DMサポート
- ファイルアップロード対応

### 3. Teams通知ベース
Microsoft Teamsへの通知送信
- Webhook経由での通知
- アダプティブカード対応
- メンション機能
- アクションボタン設定

### 4. 従業員情報取得ベース (KOT)
社内システムから従業員マスタデータを取得
- 従業員検索（ID、名前、部署等）
- 部署・役職情報取得
- キャッシュ機構
- CSV/JSON出力

### 5. 勤怠情報取得ベース (KOT)
社内システムから勤怠データを取得
- 勤怠データ取得（期間指定）
- 集計・分析機能
- 残業時間計算
- CSV出力対応

## セキュリティ注意事項

- API Key等の機密情報は必ず環境変数で管理
- `.env`ファイルは`.gitignore`に追加
- `.env.example`には実際の値を含めない
- 本番環境では適切なアクセス制御を実施

## カスタマイズ

生成されたテンプレートは以下の点でカスタマイズ可能です：
- エラーハンドリングの追加・変更
- ログレベルの調整
- データ加工ロジックの追加
- リトライ処理の追加
- バリデーション強化

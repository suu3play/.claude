# Branch Cleanup Command - ブランチ整理とmainブランチ更新

## 機能概要

ローカルブランチの状態を確認し、全てコミット・プッシュ済みの場合にブランチ整理を行います。

## 実行手順

1. **ブランチ状態確認**
   - 指定されたプロジェクトディレクトリに移動
   - `git status` でワーキングツリーの状態を確認
   - `git branch -v` でローカルブランチ一覧と追跡状況を確認
   - `git log --branches --not --remotes --oneline` で未プッシュコミットを確認

2. **安全性チェック**
   - 未コミットの変更がある場合: 警告を出してスキップ
   - 未プッシュのコミットがある場合: 警告を出してスキップ
   - 上記がない場合のみ次のステップに進む

3. **削除対象確認**
   - `git branch` でローカルブランチ一覧を取得
   - main以外のブランチを削除対象として一覧表示
   - 削除対象ブランチがある場合、ユーザーに継続確認を求める
   - ユーザーが「No」を選択した場合は処理を中断

4. **ブランチ整理実行**（確認後のみ実行）
   - `git checkout main` でmainブランチに切り替え
   - `git pull origin main` でmainブランチを最新に更新
   - 確認済みのローカルブランチを `git branch -d` で削除
   - マージされていないブランチがある場合は警告を表示

5. **実行結果報告**
   - 削除されたブランチの一覧を表示
   - mainブランチの更新状況を表示
   - 問題があった場合はエラーメッセージを表示

## 使用方法

```
/branch-cleanup [プロジェクト名]
```

## 使用例

```
/branch-cleanup source-flow
/branch-cleanup portfolio
/branch-cleanup hobby-weather
```

## 注意事項

- **破壊的操作**: ローカルブランチが削除されるため、事前に重要な作業がコミット・プッシュされていることを確認
- **安全機能**: 未コミット・未プッシュがある場合は自動的にスキップ
- **ユーザー確認**: 削除前に対象ブランチを表示して継続確認を実施
- **リモート確認**: リモートにプッシュされていないブランチは保護される
- **マージ確認**: マージされていないブランチは `-d` で安全に確認される

## エラーハンドリング

- プロジェクトディレクトリが存在しない場合
- Gitリポジトリではない場合
- リモートとの通信エラーがある場合
- ブランチ削除でエラーが発生した場合
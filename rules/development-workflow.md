# 開発ワークフロー

## 機能追加及び改修時に必ず実施すること

### 作業開始時

-   必ず作業用ブランチを作成する。命名規則は**ブランチ名のルール**に従う。
-   いかなる変更も main ブランチに直接コミットしない

### 基本的な作業の流れ

1. **厳格なコード品質チェック**を実行し、すべて成功することを確認
    - 結果は `./code_check/code_check_yyyyMMddHHmm.md` に出力（形式: `.claude/templates/code-quality-check-template.md`）
    - チェック項目詳細は `.claude/rules/testing-requirements.md` を参照
    - 主要チェック項目:
        - 型チェック（TypeScript/Python 型ヒント）
        - 構文エラーチェック
        - null / undefined チェック
        - 配列の範囲外アクセスの可能性
        - 無限ループの可能性
        - 無効な再帰
        - パス／ファイル存在確認
        - 非同期処理の漏れ（Promise 未処理、async/await 不整合）
        - スペルチェック（変数名、コメント、文字列リテラル）
        - リント・フォーマットチェック
        - ビルドが正常終了
2. 作業内容をコミット。メッセージは Conventional Commits 形式に従うこと（feat:, fix:, docs:, refactor:, test: など）
3. **修正内容をユーザーに報告し、確認を待つ**
    - 変更ファイル一覧と変更内容のサマリーを表示
    - 品質チェック結果を報告
    - 「問題なし」「続行」「コミット」などの指示があれば次のステップへ
    - 修正依頼があれば該当箇所を修正してステップ1に戻る
4. **ユーザーの承認後**、リモートブランチに push (`git push -u origin <ブランチ名>`)
5. **ユーザーから明示的に指示された場合のみ**プルリクエスト作成（PR）
    - 「PR作成」「プルリクエスト作成」「続行」などの指示を待つ
    - 自動でPR作成しない
    - PR作成時は**プルリクエスト作成時のルール**に従う

## ブランチ名のルール

-   **Issue 対応の場合**: `feature/issue-[issue番号]` の形式を使用すること
    -   例: `feature/issue-1`, `feature/issue-123`
-   **通常の機能追加**: `feature/[機能名]` の形式を使用すること
    -   例: `feature/search-optimization`, `feature/export-csv`
-   **バグ修正**: `fix/[修正内容]` の形式を使用すること
    -   例: `fix/search-performance`, `fix/memory-leak`
-   **ドキュメント更新**: `docs/[更新内容]` の形式を使用すること
    -   例: `docs/readme-update`, `docs/api-spec`

## プルリクエスト作成時のルール

-   **Issue 対応の場合**: プルリクエストのタイトルに `#[issue番号]` を含めること
    -   例: `feat: ファイルプレビュー機能を追加 #7`
    -   例: `fix: 検索バグを修正 #15`
-   **生成ツール名の取り扱い**: プルリクエスト本文には生成ツール名を記載しない。

## 重要な注意事項

### ユーザー確認フェーズの厳守

**絶対に自動で次のステップに進まないこと**

1. **コミット前の確認**
   - 修正内容をユーザーに報告し、必ず承認を得る
   - ユーザーが「問題なし」「続行」「コミット」などの明示的な指示をするまで待つ

2. **プッシュ前の確認**
   - コミット完了後、プッシュ前にもユーザーの指示を待つ
   - 自動でプッシュしない

3. **PR作成前の確認**
   - プッシュ完了後、PR作成前にユーザーの明示的な指示を待つ
   - 「PR作成」「プルリクエスト作成」などの指示があった場合のみ実行
   - **自動でPR作成しない**（最重要）

### Issue対応時の推奨フロー

Issue対応の依頼を受けた場合は、**issue-fixerスキル**の使用を推奨します。
issue-fixerスキルは、上記の確認フェーズを含む標準化されたワークフローを提供します。

- 起動キーワード: 「issue XXを改修」「issue対応」「issueから改修」など
- 各フェーズでユーザー確認を実施
- 安全で管理された開発フロー
